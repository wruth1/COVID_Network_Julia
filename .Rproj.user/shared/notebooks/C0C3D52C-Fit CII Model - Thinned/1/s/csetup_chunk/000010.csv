"0","num_students <- 17038"
"0",""
"0",""
"0","data <- read.csv(""D:/School/Thesis/COVID_Network_Julia/Data/Output/Thinned/All_Outbreak_Sizes.csv"")"
"0",""
"0","num_trials = nrow(data)"
"0",""
"0","# Number of students remaining in the network for each threshold level"
"0","network_sizes <- c(16675, 22715, 24041)"
"0",""
"0","all_thresholds <- unique(data$threshold)"
"0",""
"0","thresh2size <- function(thresh){"
"0","  if(thresh == 20){"
"0","    network_sizes[1]"
"0","  } else if(thresh == 50){"
"0","    network_sizes[2]"
"0","  } else if(thresh == 100){"
"0","    network_sizes[3]"
"0","  } else{"
"0","    stop(""Invalid threshold level."")"
"0","  }"
"0","}"
"0",""
"0","for (i in 1:(ncol(data)-1)) {"
"0","  data[, i] <- factor(data[, i])"
"0","}"
"0",""
"0","for (i in 1:(ncol(data)-2)) {"
"0","  levels(data[,i]) <- c(""low"", ""med"", ""high"")"
"0","}"
"0",""
"0",""
"0",""
"0","get_formula <- function(resp_var, control_var, data, int = TRUE){"
"0","  model_vars = data %>%"
"0","    select(-!!resp_var, -!!control_var) %>%"
"0","    names()"
"0","  "
"0","  # First-order terms"
"0","  (form_str <- paste(model_vars, collapse = "" + ""))"
"0","  (form_str <- paste(control_var, form_str, sep = "" + ""))"
"0","  (form_str <- paste(resp_var, form_str, sep = "" ~ ""))"
"0","  "
"0","  # Second-order terms. Only include interactions with the control variable"
"0","  if (int) {"
"0","    (form_int_str <- paste(model_vars, control_var, sep = ""*""))"
"0","    (form_int_str <- paste(form_int_str, collapse = "" + ""))"
"0","    (form_str <- paste(form_str, form_int_str, sep = "" + ""))"
"0","  }"
"0","  "
"0","  # Convert string to formula object"
"0","  form = formula(form_str)"
"0","  "
"0","  form"
"0","}"
"0",""
"0","data$network_size <- sapply(data$threshold, thresh2size)"
"0",""
"0","data_logit <- data %>% "
"0","  mutate(prop = size / network_size) %>% "
"0","  select(-size, -network_size)"
"0",""
